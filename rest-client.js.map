{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 9831d078bb1ccb3a6c08","webpack:///./src/rest-client.js","webpack:///./~/minivents/dist/minivents.commonjs.min.js"],"names":[],"mappings":"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","file":"rest-client.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"RestClient\"] = factory();\n\telse\n\t\troot[\"RestClient\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 9831d078bb1ccb3a6c08\n **/","import Events from 'minivents'\r\n\r\nfunction encodeUrl(data) {\r\n    let res = '';\r\n    for (let k in data)\r\n        res += encodeURIComponent(k) + '=' + encodeURIComponent(data[k]) + '&';\r\n    return res.substr(0, res.length - 1);\r\n}\r\n\r\nclass RestClient {\r\n    constructor(host, options) {\r\n        this.host = host;\r\n        this.conf(options);\r\n\r\n        new Events(this);\r\n\r\n        // resource must be super class of RestClient\r\n        // but fucking js cannot into callable objects, so...\r\n        // After this call all resource methods will be defined\r\n        // on current RestClient instance (this behaviour affected by last parameter)\r\n        // At least this parameters are symmetric :D\r\n        resource(this, undefined, '', undefined, this);\r\n    }\r\n\r\n    conf(options={}) {\r\n        let currentOptions = this._opts || {\r\n            trailing: '',\r\n            shortcut: true,\r\n            contentType: 'application/json',\r\n            'application/x-www-form-urlencoded': {encode: encodeUrl},\r\n            'application/json': {encode: JSON.stringify, decode: JSON.parse}\r\n        };\r\n\r\n        this._opts = Object.assign(currentOptions, options);\r\n\r\n        return Object.assign({}, this._opts);\r\n    }\r\n\r\n    _request(method, url, data=null, contentType=null) {\r\n        if (url.indexOf('?') == -1)\r\n            url += this._opts.trailing;\r\n        else\r\n            url = url.replace('?', this._opts.trailing + '?');\r\n\r\n        let xhr = new XMLHttpRequest();\r\n        xhr.open(method, this.host + url, true);\r\n\r\n        if (contentType) {\r\n            let mime = this._opts[contentType];\r\n            if (mime && mime.encode)\r\n                data = mime.encode(data);\r\n            xhr.setRequestHeader('Content-Type', contentType);\r\n        }\r\n\r\n        this.emit('request', xhr);\r\n\r\n        let p = new Promise((resolve, reject) => {\r\n            xhr.onreadystatechange = () => {\r\n                if (xhr.readyState == 4) {\r\n                    this.emit('response', xhr);\r\n                    if (xhr.status == 200 || xhr.status == 201 || xhr.status == 204) {\r\n                        this.emit('success', xhr);\r\n\r\n                        const contentTypeHeader = xhr.getResponseHeader('Content-Type');\r\n\r\n                        if (contentTypeHeader === null) {\r\n                            let res = xhr.responseText;\r\n                            resolve(res);\r\n                        } else {\r\n                            let responseContentType = xhr.getResponseHeader('Content-Type').split(';')[0];\r\n                            let mime = this._opts[responseContentType];\r\n                            let res = xhr.responseText;\r\n                            if (mime && mime.decode)\r\n                                res = mime.decode(res);\r\n\r\n                            resolve(res);\r\n                        }\r\n                    } else {\r\n                        this.emit('error', xhr);\r\n                        reject(xhr);\r\n                    }\r\n                }\r\n            };\r\n        });\r\n        xhr.send(data);\r\n        return p;\r\n    }\r\n}\r\n\r\nfunction resource(client, parent, name, id, ctx) {\r\n    let self = ctx ? ctx : (newId) => {\r\n        if (newId == undefined)\r\n            return self;\r\n        return self._clone(parent, newId);\r\n    };\r\n\r\n    self._resources = {};\r\n    self._shortcuts = {};\r\n\r\n    self._clone = (parent, newId) => {\r\n        let copy = resource(client, parent, name, newId);\r\n        copy._shortcuts = self._shortcuts;\r\n        for (let resName in self._resources) {\r\n            copy._resources[resName] = self._resources[resName]._clone(copy);\r\n\r\n            if (resName in copy._shortcuts)\r\n                copy[resName] = copy._resources[resName];\r\n        }\r\n        return copy;\r\n    };\r\n\r\n    self.res = (resources, shortcut=client._opts.shortcut) => {\r\n        let makeRes = (resName) => {\r\n            if (resName in self._resources)\r\n                return self._resources[resName];\r\n\r\n            let r = resource(client, self, resName);\r\n            self._resources[resName] = r;\r\n            if (shortcut) {\r\n                self._shortcuts[resName] = r;\r\n                self[resName] = r;\r\n            }\r\n            return r;\r\n        };\r\n\r\n        // (resources instanceof String) don't work. Fuck you, javascript.\r\n        if (resources.constructor == String)\r\n            return makeRes(resources);\r\n\r\n        if (resources instanceof Array)\r\n            return resources.map(makeRes);\r\n\r\n        if (resources instanceof Object) {\r\n            let res = {};\r\n            for (let resName in resources) {\r\n                let r = makeRes(resName);\r\n                if (resources[resName])\r\n                    r.res(resources[resName]);\r\n                res[resName] = r;\r\n            }\r\n            return res;\r\n        }\r\n    };\r\n\r\n    self.url = () => {\r\n        let url = parent ? parent.url() : '';\r\n        if (name)\r\n            url += '/' + name;\r\n        if (id != undefined)\r\n            url += '/' + id;\r\n        return url;\r\n    };\r\n\r\n    self.get = (args) => {\r\n        let url = self.url();\r\n        if (args)\r\n            url += '?' + encodeUrl(args);\r\n        return client._request('GET', url);\r\n    };\r\n\r\n    self.post = (data, contentType = client._opts.contentType) => {\r\n        return client._request('POST', self.url(), data, contentType);\r\n    };\r\n\r\n    self.put = (data, contentType = client._opts.contentType) => {\r\n        return client._request('PUT', self.url(), data, contentType);\r\n    };\r\n\r\n    self.patch = (data, contentType = client._opts.contentType) => {\r\n        return client._request('PATCH', self.url(), data, contentType);\r\n    };\r\n\r\n    self.delete = () => {\r\n        return client._request('DELETE', self.url());\r\n    };\r\n    return self;\r\n}\r\n\r\nmodule.exports = RestClient;\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/rest-client.js\n **/","module.exports=function(n){var t={},e=[];n=n||this,n.on=function(n,e,l){(t[n]=t[n]||[]).push([e,l])},n.off=function(n,l){n||(t={});for(var o=t[n]||e,i=o.length=l?o.length:0;i--;)l==o[i][0]&&o.splice(i,1)},n.emit=function(n){for(var l,o=t[n]||e,i=o.length>0?o.slice(0,o.length):o,c=0;l=i[c++];)l[0].apply(l[1],e.slice.call(arguments,1))}};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/minivents/dist/minivents.commonjs.min.js\n ** module id = 1\n ** module chunks = 0 1\n **/"],"sourceRoot":""}